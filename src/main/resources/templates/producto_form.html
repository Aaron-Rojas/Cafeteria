<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title th:text="${producto.id == null ? 'Crear Producto' : 'Editar Producto'}"></title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <!-- Si tienes un CSS para el admin, agrégalo aquí -->
    <!-- <link rel='stylesheet' type='text/css' media='screen' th:href="@{/css/admin.css}"> -->
</head>
<body>
    <div class="container mt-5">
        <h2 class="mb-4" th:text="${producto.id == null ? 'Crear Nuevo Producto' : 'Editar Producto'}"></h2>

        <!-- th:object="${producto}" vincula el formulario al objeto Producto del modelo -->
        <form th:action="@{/admin/productos/guardar}" th:object="${producto}" method="post">
            <!-- Campo oculto para el ID del producto (importante para saber si es nuevo o edición) -->
            <input type="hidden" th:field="*{id}" />

            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre:</label>
                <input type="text" class="form-control" id="nombre" th:field="*{nombre}" required>
            </div>
            <div class="mb-3">
                <label for="descripcion" class="form-label">Descripción:</label>
                <textarea class="form-control" id="descripcion" th:field="*{descripcion}" rows="3"></textarea>
            </div>
            <div class="mb-3">
                <label for="precio" class="form-label">Precio:</label>
                <input type="number" step="0.01" class="form-control" id="precio" th:field="*{precio}" required>
            </div>
            <div class="mb-3">
                <label for="urlImagen" class="form-label">URL Imagen:</label>
                <input type="text" class="form-control" id="urlImagen" th:field="*{urlImagen}">
                <small class="form-text text-muted">Ej: /images/cafe_americano.png</small>
            </div>
            <div class="mb-3">
                <label for="categoria" class="form-label">Categoría:</label>
                <!-- Usamos th:field="*{categoria.id}" para vincular al ID de la categoría del Producto -->
                <select class="form-select" id="categoria" th:field="*{categoria.id}" required>
                    <option value="">Seleccione una categoría</option>
                    <option th:each="cat : ${categorias}" 
                            th:value="${cat.id}" 
                            th:text="${cat.nombre}"
                            th:selected="${producto.categoria != null and producto.categoria.id == cat.id}">
                    </option>
                </select>
            </div>

            <button type="submit" class="btn btn-success me-2">Guardar Producto</button>
            <a th:href="@{/admin/productos}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
</body>
</html>