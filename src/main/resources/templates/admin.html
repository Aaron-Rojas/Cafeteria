<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Panel Administrador</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='/css/admin.css'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script src='main.js'></script>
</head>
<body>
<div class="container-fluid p-0 m-0">
    <div class="col-12">
        <header>
            <nav>
                <ul class="barranavegacion p-2">
                    <li class="ms-3"><a href=""> Cliente</a></li>
                    <li class="ms-1"><a href=""> Reservas</a></li>
                    <li class="ms-1"><a href=""> Menú </a></li>
                    <li class="ms-1"><a href="">Eventos</a></li>
                </ul>
            </nav>
        </header>
    </div>

    <h1 class="m-4">Bienvenido</h1>
    <h2 class="ms-4 ps-3"> Registro de reservas </h2>

    <div th:if="${listaReservas == null}">
        <h3>Lista null? true</h3>
        <p>No hay datos disponibles</p>
    </div>

    <div th:if="${listaReservas != null}" class="m-4 p-2 table-responsive">
        <h5 th:text="'Reservas encontradas: ' + ${listaReservas.size()}"></h5>

        <table class="table table-striped table-hover table-bordered text-center m-2">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Usuario</th>
                <th>Mesa</th>
                <th>Fecha</th>
                <th>Duración</th>
                <th>Personas</th>
                <th>Estado</th>
                <th>Notas</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="reserva : ${listaReservas}">
                <td th:text="${reserva.id}"></td>
                <td th:text="${reserva.usuarioId}"></td>
                <td th:text="${reserva.mesaId}"></td>
                <td th:text="${#temporals.format(reserva.fechaHoraReserva, 'dd/MM/yyyy HH:mm')}"></td>
                <td th:text="${reserva.duracionMinutos}"></td>
                <td th:text="${reserva.cantidadPersonas}"></td>
                <td>
                    <span th:text="${reserva.estado}" 
                          th:classappend="'badge ' + 
                            (${reserva.estado.name() == 'Confirmada'} ? 'bg-success' : 
                            (${reserva.estado.name() == 'Pendiente'} ? 'bg-warning text-dark' : 
                            (${reserva.estado.name() == 'Cancelada'} ? 'bg-danger' : 'bg-secondary')))">
                    </span>
                </td>
                <td th:text="${reserva.notas}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="ms-4 p-3">
        <button class="btn btn-dark" type="submit">Añadir</button>
        <button class="btn btn-dark" type="submit">Editar</button>
        <button class="btn btn-dark" type="submit">Eliminar</button>
    </div>

    <script th:inline="javascript">
        let reservas = /*[[${listaReservas}]]*/ [];
        document.write('<pre>' + JSON.stringify(reservas, null, 2) + '</pre>');
    </script>
</div>
</body>
</html>